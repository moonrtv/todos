$(function(){function t(t){var e=this;$(document).bind("mouseup",function(a){$(e).is(a.target)||0!==$(e).has(a.target).length||($(document).unbind("mouseup"),t.title=$(e).find(".todo__list-edit").val(),$(e).removeClass("js-editing"),s.renderTasks(s))})}var s=new Tasks,e=$("#enterTask"),a={};localStorage.getItem("todos")&&(a=JSON.parse(localStorage.getItem("todos")),a.tasks.forEach(function(t){s.addTask(new Task({title:t.title,status:t.status}))}),s.renderTasks(s)),e.bind("keypress",function(t){13===t.keyCode&&this.value&&(s.addTask(new Task({title:this.value,status:!1})),s.renderTasks(s),e.val(""))}),$("li").live("click",function(e){var a=e.target,i=parseInt($(this).attr("data-id")),o={};switch(a.className){case"todo__list-destroy":s.delTask(i),s.renderTasks(s);break;case"todo__list-title":o=s.getTask(i),o.toggleStatus(),localStorage.clear(),localStorage.setItem("todos",JSON.stringify(s));break;case"todo__list-editing":"LI"===$(this)[0].tagName&&($(this).addClass("js-editing"),o=s.getTask(i),$(this).find(".todo__list-edit").val(o.title),t.call(this,o))}})}),function(){function t(t){this.title=t.title||"New task",this.status=t.status||!1}t.prototype.toggleStatus=function(){this.status=!this.status},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(t){this.title=t},window.Task=t}(),function(){function t(){this.tasks=[]}t.prototype.addTask=function(t){this.tasks.push(t)},t.prototype.delTask=function(t){this.tasks.splice(t,1)},t.prototype.getTask=function(t){return this.tasks[t]},t.prototype.renderTasks=function(t){$("#listId").remove(),t.tasks.sort(this.sortTasks),localStorage.clear(),localStorage.setItem("todos",JSON.stringify(t)),$("#parentId").append(App.templates.task.template(t))},t.prototype.sortTasks=function(t,s){var e=/([^\d]+|\d+)/gi;t=t.title,s=s.title;for(var a=t.match(e),i=s.match(e),o=0,n=Math.min(a.length,i.length);o<n;o++){var r=a[o],l=i[o];if(r!==l)return isNaN(+r)||isNaN(+l)?r<l?1:-1:+l-r}return a.length-i.length},window.Tasks=t}();